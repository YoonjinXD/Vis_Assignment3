<!doctype html>
<html lang="en">
  <head>

      <title>Assignment3_YJ_Chung</title>

      <!-- Required meta tags -->
      <meta charset="utf-8">

      <!-- Semantic UI !-->
      <link rel="stylesheet" type="text/css" href="semantic/semantic.min.css">

      <!-- From D3.js !-->

      <script src="https://d3js.org/d3.v4.min.js"></script>
      <link rel="stylesheet" type="text/css" href="custom.css">



  </head>
  <body>

      <div class="ui container">

          <div class="ui hidden divider"></div>


          <div class="ui container">
              <div class="ui grid">

                  <div class="ui eight wide column">
                      <h2 class="ui center aligned icon header">
                          <i class="stethoscope icon"></i>
                          <div class="content">
                              Cancer Types in Denmark
                              <div class="sub header">From 1991 - 2015</div>
                          </div>
                      </h2>
                  </div>

                  <div class="ui four wide column">
                      <div class="ui segment">
                          <div class="ui form">
                              <div class="grouped fields">
                                  <h4 class="ui centered aligned header">Select Data</h4>
                                  <div class="field">
                                      <div class="ui slider checkbox">
                                          <input type="radio" name="selected" checked="checked" onclick="toggle_men()">
                                          <label>Men</label>
                                      </div>
                                  </div>
                                  <div class="field">
                                      <div class="ui slider checkbox">
                                          <input type="radio" name="selected" onclick="toggle_women()">
                                          <label>Women</label>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>

                  <div class="ui four wide column">
                      <div id="Menlegend" class="ui segment">
                          <div class="ui middle aligned animated list">
                              <div class="item">
                                  <i class="circle icon orange"></i>
                                  <div class="content">
                                      <div class="header">Prostate Cancer</div>
                                  </div>
                              </div>
                              <div class="item">
                                  <i class="circle icon red"></i>
                                  <div class="content">
                                      <div class="header">Colon and rectum Cancer</div>
                                  </div>
                              </div>
                              <div class="item">
                                  <i class="circle icon blue"></i>
                                  <div class="content">
                                      <div class="header">Lung Cancer</div>
                                  </div>
                              </div>
                              <div class="item">
                                  <i class="circle icon green"></i>
                                  <div class="content">
                                      <div class="header">Urinary Cancer</div>
                                  </div>
                              </div>
                          </div>
                      </div>

                      <div id="Womenlegend"  class="ui segment" style="display: none; margin:0px">
                          <div class="ui middle aligned animated list">
                              <div class="item">
                                  <i class="circle icon orange"></i>
                                  <div class="content">
                                      <div class="header">Breast Cancer</div>
                                  </div>
                              </div>
                              <div class="item">
                                  <i class="circle icon red"></i>
                                  <div class="content">
                                      <div class="header">Colon and Rectum Cancer</div>
                                  </div>
                              </div>
                              <div class="item">
                                  <i class="circle icon blue"></i>
                                  <div class="content">
                                      <div class="header">Lung Cancer</div>
                                  </div>
                              </div>
                              <div class="item">
                                  <i class="circle icon green"></i>
                                  <div class="content">
                                      <div class="header">Uterus and Ovary Cancer</div>
                                  </div>
                              </div>
                          </div>
                      </div>

                  </div>

              </div>
              <div class="ui segment">
                  <div id="Male"></div>
                  <div id="Female" style="display: none"></div>
              </div>

          </div>

      </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS, then Semantic !-->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
      <script src="semantic/semantic.min.js"></script>

      <!-- Toggle !-->
      <script>
          var men = document.getElementById("Male");
          var women = document.getElementById("Female");
          var menlegend = document.getElementById("Menlegend");
          var womenlegend = document.getElementById("Womenlegend");

          function toggle_women() {
              if(women.style.display == 'none') {
                  women.style.display = 'block';
                  womenlegend.style.display = 'block';
                  men.style.display = 'none';
                  menlegend.style.display = 'none';
              }
          }
          function toggle_men() {
              if(men.style.display == 'none') {
                  men.style.display = 'block';
                  menlegend.style.display = 'block';
                  women.style.display = 'none';
                  womenlegend.style.display = 'none';
              }
          }
      </script>


      <script>
          var data = [
              {
                  name: "Lung Cancer",
                  values: [
                      {date: "1991", price: "2355"},
                      {date: "1992", price: "2402"},
                      {date: "1993", price: "2414"},
                      {date: "1994", price: "2419"},
                      {date: "1995", price: "2383"},
                      {date: "1996", price: "2300"},
                      {date: "1997", price: "2405"},
                      {date: "1998", price: "2283"},
                      {date: "1999", price: "2375"},
                      {date: "2000", price: "2466"},
                      {date: "2001", price: "2372"},
                      {date: "2002", price: "2445"},
                      {date: "2003", price: "2375"},
                      {date: "2004", price: "2457"},
                      {date: "2005", price: "2485"},
                      {date: "2006", price: "2508"},
                      {date: "2007", price: "2636"},
                      {date: "2008", price: "2607"},
                      {date: "2009", price: "2622"},
                      {date: "2010", price: "2687"},
                      {date: "2011", price: "2663"},
                      {date: "2012", price: "2750"},
                      {date: "2013", price: "2597"},
                      {date: "2014", price: "2784"},
                      {date: "2015", price: "2692"},
                  ]
              },
              {
                  name: "Prostate Cancer",
                  values: [
                      {date: "1991", price: "1858"},
                      {date: "1992", price: "1846"},
                      {date: "1993", price: "1788"},
                      {date: "1994", price: "1789"},
                      {date: "1995", price: "1759"},
                      {date: "1996", price: "1887"},
                      {date: "1997", price: "1992"},
                      {date: "1998", price: "2147"},
                      {date: "1999", price: "2269"},
                      {date: "2000", price: "2380"},
                      {date: "2001", price: "2422"},
                      {date: "2002", price: "2717"},
                      {date: "2003", price: "2864"},
                      {date: "2004", price: "3632"},
                      {date: "2005", price: "2860"},
                      {date: "2006", price: "4052"},
                      {date: "2007", price: "4527"},
                      {date: "2008", price: "4913"},
                      {date: "2009", price: "5135"},
                      {date: "2010", price: "4503"},
                      {date: "2011", price: "4748"},
                      {date: "2012", price: "4809"},
                      {date: "2013", price: "4702"},
                      {date: "2014", price: "5011"},
                      {date: "2015", price: "4935"},
                  ]
              },
              {
                  name: "Uninary Cancer",
                  values: [
                      {date: "1991", price: "1581"},
                      {date: "1992", price: "1620"},
                      {date: "1993", price: "1651"},
                      {date: "1994", price: "1608"},
                      {date: "1995", price: "1487"},
                      {date: "1996", price: "1571"},
                      {date: "1997", price: "1626"},
                      {date: "1998", price: "1698"},
                      {date: "1999", price: "1691"},
                      {date: "2000", price: "1647"},
                      {date: "2001", price: "1599"},
                      {date: "2002", price: "1613"},
                      {date: "2003", price: "1738"},
                      {date: "2004", price: "1803"},
                      {date: "2005", price: "1834"},
                      {date: "2006", price: "1839"},
                      {date: "2007", price: "1815"},
                      {date: "2008", price: "1905"},
                      {date: "2009", price: "2000"},
                      {date: "2010", price: "2005"},
                      {date: "2011", price: "2120"},
                      {date: "2012", price: "2132"},
                      {date: "2013", price: "2243"},
                      {date: "2014", price: "2368"},
                      {date: "2015", price: "2309"},
                  ]
              },
              {
                  name: "Colon and Rectum Cancer",
                  values: [
                      {date: "1991", price: "2689"},
                      {date: "1992", price: "2868"},
                      {date: "1993", price: "2855"},
                      {date: "1994", price: "2888"},
                      {date: "1995", price: "2701"},
                      {date: "1996", price: "2792"},
                      {date: "1997", price: "2865"},
                      {date: "1998", price: "2944"},
                      {date: "1999", price: "2982"},
                      {date: "2000", price: "2988"},
                      {date: "2001", price: "3164"},
                      {date: "2002", price: "3188"},
                      {date: "2003", price: "3235"},
                      {date: "2004", price: "3381"},
                      {date: "2005", price: "3444"},
                      {date: "2006", price: "3596"},
                      {date: "2007", price: "3533"},
                      {date: "2008", price: "3734"},
                      {date: "2009", price: "3845"},
                      {date: "2010", price: "3968"},
                      {date: "2011", price: "4017"},
                      {date: "2012", price: "4163"},
                      {date: "2013", price: "4169"},
                      {date: "2014", price: "4784"},
                      {date: "2015", price: "4915"},
                  ]
              }
          ];

          var Fdata = [
              {
                  name: "Lung Cancer",
                  values: [
                      {date: "1991", price: "1262"},
                      {date: "1992", price: "1240"},
                      {date: "1993", price: "1350"},
                      {date: "1994", price: "1490"},
                      {date: "1995", price: "1442"},
                      {date: "1996", price: "1430"},
                      {date: "1997", price: "1536"},
                      {date: "1998", price: "1556"},
                      {date: "1999", price: "1661"},
                      {date: "2000", price: "1650"},
                      {date: "2001", price: "1800"},
                      {date: "2002", price: "1774"},
                      {date: "2003", price: "1833"},
                      {date: "2004", price: "1950"},
                      {date: "2005", price: "2029"},
                      {date: "2006", price: "2131"},
                      {date: "2007", price: "2150"},
                      {date: "2008", price: "2129"},
                      {date: "2009", price: "2304"},
                      {date: "2010", price: "2342"},
                      {date: "2011", price: "2342"},
                      {date: "2012", price: "2326"},
                      {date: "2013", price: "2430"},
                      {date: "2014", price: "2377"},
                      {date: "2015", price: "2462"},
                  ]
              },
              {
                  name: "Breast Cancer",
                  values: [
                      {date: "1991", price: "3057"},
                      {date: "1992", price: "3385"},
                      {date: "1993", price: "3147"},
                      {date: "1994", price: "3219"},
                      {date: "1995", price: "3295"},
                      {date: "1996", price: "3496"},
                      {date: "1997", price: "3475"},
                      {date: "1998", price: "3600"},
                      {date: "1999", price: "3706"},
                      {date: "2000", price: "3790"},
                      {date: "2001", price: "3899"},
                      {date: "2002", price: "4130"},
                      {date: "2003", price: "3975"},
                      {date: "2004", price: "4017"},
                      {date: "2005", price: "4042"},
                      {date: "2006", price: "4213"},
                      {date: "2007", price: "4211"},
                      {date: "2008", price: "4870"},
                      {date: "2009", price: "5874"},
                      {date: "2010", price: "5205"},
                      {date: "2011", price: "4747"},
                      {date: "2012", price: "4663"},
                      {date: "2013", price: "4838"},
                      {date: "2014", price: "4842"},
                      {date: "2015", price: "4785"},
                  ]
              },
              {
                  name: "Uterus and Ovary Cancer",
                  values: [
                      {date: "1991", price: "1882"},
                      {date: "1992", price: "1957"},
                      {date: "1993", price: "1880"},
                      {date: "1994", price: "1869"},
                      {date: "1995", price: "1849"},
                      {date: "1996", price: "1828"},
                      {date: "1997", price: "1776"},
                      {date: "1998", price: "1791"},
                      {date: "1999", price: "1812"},
                      {date: "2000", price: "1759"},
                      {date: "2001", price: "1819"},
                      {date: "2002", price: "1753"},
                      {date: "2003", price: "1778"},
                      {date: "2004", price: "1703"},
                      {date: "2005", price: "1762"},
                      {date: "2006", price: "1761"},
                      {date: "2007", price: "1725"},
                      {date: "2008", price: "1767"},
                      {date: "2009", price: "1885"},
                      {date: "2010", price: "1747"},
                      {date: "2011", price: "1888"},
                      {date: "2012", price: "1848"},
                      {date: "2013", price: "1912"},
                      {date: "2014", price: "1864"},
                      {date: "2015", price: "1904"},
                  ]
              },
              {
                  name: "Colon and Rectum Cancer",
                  values: [
                      {date: "1991", price: "2639"},
                      {date: "1992", price: "2661"},
                      {date: "1993", price: "2610"},
                      {date: "1994", price: "2628"},
                      {date: "1995", price: "2557"},
                      {date: "1996", price: "2526"},
                      {date: "1997", price: "2765"},
                      {date: "1998", price: "2822"},
                      {date: "1999", price: "2736"},
                      {date: "2000", price: "2587"},
                      {date: "2001", price: "2821"},
                      {date: "2002", price: "2754"},
                      {date: "2003", price: "2726"},
                      {date: "2004", price: "2905"},
                      {date: "2005", price: "2853"},
                      {date: "2006", price: "3122"},
                      {date: "2007", price: "3057"},
                      {date: "2008", price: "3155"},
                      {date: "2009", price: "3091"},
                      {date: "2010", price: "3143"},
                      {date: "2011", price: "3345"},
                      {date: "2012", price: "3361"},
                      {date: "2013", price: "3227"},
                      {date: "2014", price: "3721"},
                      {date: "2015", price: "3793"},
                  ]
              }
          ];

          var width = 1050;
          var height = 550;
          var margin = 50;
          var duration = 250;

          var lineOpacity = "0.25";
          var lineOpacityHover = "0.85";
          var otherLinesOpacityHover = "0.1";
          var lineStroke = "4px";
          var lineStrokeHover = "5px";

          var circleOpacity = '0.85';
          var circleOpacityOnLineHover = "0.25"
          var circleRadius = 3;
          var circleRadiusHover = 6;

          /* Format Data */
          var parseDate = d3.timeParse("%Y");
          data.forEach(function(d) {
              d.values.forEach(function(d) {
                  d.date = parseDate(d.date);
                  d.price = +d.price;
              });
          });


          /* Scale */
          var xScale = d3.scaleTime()
              .domain(d3.extent(data[0].values, d => d.date))
              .range([0, width-margin]);

          var yScale = d3.scaleLinear()
              .domain([1000, 5500])
              .range([height-margin, 0]);

          var color = d3.scaleOrdinal(d3.schemeCategory10);

          /* Add SVG */
          var svg = d3.select("#Male").append("svg")
              .attr("width", (width+margin)+"rem")
              .attr("height", (height+margin)+"px")
              .append('g')
              .attr("transform", `translate(${margin}, ${margin})`);


          /* Add line into SVG */
          var line = d3.line()
              .x(d => xScale(d.date))
              .y(d => yScale(d.price));

          let lines = svg.append('g')
              .attr('class', 'lines');

          lines.selectAll('.line-group')
              .data(data).enter()
              .append('g')
              .attr('class', 'line-group')
              .on("mouseover", function(d, i) {
                  svg.append("text")
                      .attr("class", "title-text")
                      .style("fill", color(i))
                      .text(d.name)
                      .attr("text-anchor", "middle")
                      .attr("x", (width-margin)/2)
                      .attr("y", 5);
              })
              .on("mouseout", function(d) {
                  svg.select(".title-text").remove();
              })
              .append('path')
              .attr('class', 'line')
              .attr('d', d => line(d.values))
              .style('stroke', (d, i) => color(i))
              .style('opacity', lineOpacity)
              .on("mouseover", function(d) {
                  d3.selectAll('.line')
                      .style('opacity', otherLinesOpacityHover);
                  d3.selectAll('.circle')
                      .style('opacity', circleOpacityOnLineHover);
                  d3.select(this)
                      .style('opacity', lineOpacityHover)
                      .style("stroke-width", lineStrokeHover)
                      .style("cursor", "pointer");
              })
              .on("mouseout", function(d) {
                  d3.selectAll(".line")
                      .style('opacity', lineOpacity);
                  d3.selectAll('.circle')
                      .style('opacity', circleOpacity);
                  d3.select(this)
                      .style("stroke-width", lineStroke)
                      .style("cursor", "none");
              });


          /* Add circles in the line */
          lines.selectAll("circle-group")
              .data(data).enter()
              .append("g")
              .style("fill", (d, i) => color(i))
              .selectAll("circle")
              .data(d => d.values).enter()
              .append("g")
              .attr("class", "circle")
              .on("mouseover", function(d) {
                  d3.select(this)
                      .style("cursor", "pointer")
                      .append("text")
                      .attr("class", "text")
                      .text(`${d.price}`)
                      .attr("x", d => xScale(d.date) + 5)
                      .attr("y", d => yScale(d.price) - 10);
              })
              .on("mouseout", function(d) {
                  d3.select(this)
                      .style("cursor", "none")
                      .transition()
                      .duration(duration)
                      .selectAll(".text").remove();
              })
              .append("circle")
              .attr("cx", d => xScale(d.date))
              .attr("cy", d => yScale(d.price))
              .attr("r", circleRadius)
              .style('opacity', circleOpacity)
              .on("mouseover", function(d) {
                  d3.select(this)
                      .transition()
                      .duration(duration)
                      .attr("r", circleRadiusHover);
              })
              .on("mouseout", function(d) {
                  d3.select(this)
                      .transition()
                      .duration(duration)
                      .attr("r", circleRadius);
              });


          /* Add Axis into SVG */
          var xAxis = d3.axisBottom(xScale).ticks(25);
          var yAxis = d3.axisLeft(yScale).ticks(5);

          svg.append("g")
              .attr("class", "x axis")
              .attr("transform", `translate(0, ${height-margin})`)
              .call(xAxis);

          svg.append("g")
              .attr("class", "y axis")
              .call(yAxis)
              .append('text')
              .attr("y", 15)
              .attr("transform", "rotate(-90)")
              .attr("fill", "#000")
              .text("Cancer cases");

          // 일단은 야매로 이렇게 해놓음.
          data = Fdata;

          /* Format Data */
          parseDate = d3.timeParse("%Y");
          data.forEach(function(d) {
              d.values.forEach(function(d) {
                  d.date = parseDate(d.date);
                  d.price = +d.price;
              });
          });

          /* Add SVG */
          var svge = d3.select("#Female").append("svg")
              .attr("width", (width+margin)+"rem")
              .attr("height", (height+margin)+"rem")
              .append('g')
              .attr("transform", `translate(${margin}, ${margin})`);


          /* Add line into SVG */
          line = d3.line()
              .x(d => xScale(d.date))
              .y(d => yScale(d.price));

          lines = svge.append('g')
              .attr('class', 'lines');

          lines.selectAll('.line-group')
              .data(data).enter()
              .append('g')
              .attr('class', 'line-group')
              .on("mouseover", function(d, i) {
                  svge.append("text")
                      .attr("class", "title-text")
                      .style("fill", color(i))
                      .text(d.name)
                      .attr("text-anchor", "middle")
                      .attr("x", (width-margin)/2)
                      .attr("y", 5);
              })
              .on("mouseout", function(d) {
                  svge.select(".title-text").remove();
              })
              .append('path')
              .attr('class', 'line')
              .attr('d', d => line(d.values))
              .style('stroke', (d, i) => color(i))
              .style('opacity', lineOpacity)
              .on("mouseover", function(d) {
                  d3.selectAll('.line')
                      .style('opacity', otherLinesOpacityHover);
                  d3.selectAll('.circle')
                      .style('opacity', circleOpacityOnLineHover);
                  d3.select(this)
                      .style('opacity', lineOpacityHover)
                      .style("stroke-width", lineStrokeHover)
                      .style("cursor", "pointer");
              })
              .on("mouseout", function(d) {
                  d3.selectAll(".line")
                      .style('opacity', lineOpacity);
                  d3.selectAll('.circle')
                      .style('opacity', circleOpacity);
                  d3.select(this)
                      .style("stroke-width", lineStroke)
                      .style("cursor", "none");
              });


          /* Add circles in the line */
          lines.selectAll("circle-group")
              .data(data).enter()
              .append("g")
              .style("fill", (d, i) => color(i))
              .selectAll("circle")
              .data(d => d.values).enter()
              .append("g")
              .attr("class", "circle")
              .on("mouseover", function(d) {
                  d3.select(this)
                      .style("cursor", "pointer")
                      .append("text")
                      .attr("class", "text")
                      .text(`${d.price}`)
                      .attr("x", d => xScale(d.date) + 5)
                      .attr("y", d => yScale(d.price) - 10);
              })
              .on("mouseout", function(d) {
                  d3.select(this)
                      .style("cursor", "none")
                      .transition()
                      .duration(duration)
                      .selectAll(".text").remove();
              })
              .append("circle")
              .attr("cx", d => xScale(d.date))
              .attr("cy", d => yScale(d.price))
              .attr("r", circleRadius)
              .style('opacity', circleOpacity)
              .on("mouseover", function(d) {
                  d3.select(this)
                      .transition()
                      .duration(duration)
                      .attr("r", circleRadiusHover);
              })
              .on("mouseout", function(d) {
                  d3.select(this)
                      .transition()
                      .duration(duration)
                      .attr("r", circleRadius);
              });

          svge.append("g")
              .attr("class", "x axis")
              .attr("transform", `translate(0, ${height-margin})`)
              .call(xAxis);

          svge.append("g")
              .attr("class", "y axis")
              .call(yAxis)
              .append('text')
              .attr("y", 15)
              .attr("transform", "rotate(-90)")
              .attr("fill", "#000")
              .text("Cancer cases");

      </script>

  </body>
</html>
